# CounterFactual:广义状态通道

Jeff Coleman，Liam Horne，and Li Xuanji

L4*

(日期：2018.6.12)

摘要：状态通道是为区块链用户减少费用的重要技术。在其适用范围之内，状态通道允许用户
互相交易而无需支付区块链交易费用和即时终止性，并且是实现后者性质的唯一技术。我们擘画了
广义状态通道，一种允许用户在不触及区块链的情况下在已有通道中安装新功能的构造，在通道内使用合约的反事实实例化。
我们提出一种构建在以太坊之上的面向对象方法，它将功能和状态封装在反事实实例化的合约中，提供胜过单一方法的隐私，效率和安全性优势，
并描述一种新的面向对象的元通道方法以构建状态通道网络。我们分析通道的独特安全假设并描述了通道用户可以收益于第三方服务。

# 1 引言

## 1.1 状态通道：基本概述

## 1.2 和其他技术的对比

## 1.3 状态通道的好处

## 1.4 状态通道的广义框架

# 2 需求&目标

# 3 威胁模型

## 3.1 共同假设

### 3.1.1 依赖区块链活性

### 3.1.2 依赖参与者可用性

### 3.1.3 缺失外部激励

### 3.1.4 缺失软件错误

## 3.2 恶意破坏

## 3.3 

### 3.3.1 为什么存在不可用的悲伤策略

### 3.3.2 减轻不可用的恶意破坏

## 3.4 

### 3.4.1 攻击检测

### 3.4.2 惩罚

## 3.5 发起人支付费用

## 3.6 经济风险

### 3.6.1 没有风险

### 3.6.2 有限的经济风险

### 3.6.3 有限的悲伤因子

## 3.7 其他有用的威胁模型

# 4 前人的工作

## 4.1 单个通道内的一般性

### 4.1.1 支付通道

### 4.1.2 状态通道

### 4.1.3 广义状态通道

## 4.2 跨中介交互

## 4.3 已有设计方案

### 4.3.1 闪电网络

### 4.3.2 雷电网络

### 4.3.2 Sprites

### 4.3.3 Perun

# 5 概念和定义

## 5.1 Counterfactual术语


## 5.2 Counterfactual状态

## 5.3 Counterfactual实例化

### 5.3.1 Counterfactual寻址

###5.4 最小化链上功能和状态

## 5.5 组织链下状态和交互

### 5.5.1 Counterfactual对象

### 5.5.2 分配押金状态

### 5.5.3 Counterfactual对象之间的关系

### 5.5.4 依赖nonce的条件终结

### 5.5.5 原子状态转移

### 5.5.6 根nonce

## 5.6 与链上状态交互

## 5.7 面向对象方法

### 5.7.1 条件支付

### 5.7.2 及时取款和充值

### 5.7.3 优点

## 5.8 变更参与者集合

## 5.9 元通道

# 6 构造广义状态通道

## 6.1 实现技术

### 6.1.1 基于dalegatecall的承诺


### 6.1.2 Counterfactual承诺

### 6.1.3 在注册表中认证

### 6.1.4 多重签名所有者

### 6.1.5 根nonce

## 6.2 链上部分


### 6.2.1 多重签名钱包

### 6.2.2 注册表

## 6.3 Counterfactual对象


### 6.3.1 API

## 6.4 底层协议

### 6.4.1 链上交易


### 6.4.2 SignCommitment

### 6.4.3 实例化

### 6.4.4 更新

### 6.4.5 CommitWithdrawal

## 6.5 Counterfactual对象原语

### 6.5.1 根nonce

### 6.5.2 支付合约

### 6.5.3 余额退款合约

## 6.6 协议

### 6.6.1 创建一个新的状态通道

### 6.6.2 在支付通道中支付


### 6.6.2 创建一个新的状态通道

### 6.6.3 在状态通道中安装新应用

### 6.6.4 增加状态押金

### 6.6.5 即时取款

## 6.7 元通道

### 6.7.1 用显式所有者实例化

### 6.7.2 更新显式所有者

### 6.7.3 代理支付合约
### 6.7.4 创建元通道协议

# 7 下一步工作

## 7.1 广义状态通道的性能

## 7.2 支撑服务
## 7.3 其他技术和子通道类型

### 7.3.1 链下时间
### 7.3.2 高级密钥管理
### 7.3.3 高吞吐支付
# 致谢







 





